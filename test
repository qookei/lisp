(define (list . values)
    values)

(define (map fn lst)
    (if (nil? lst)
	'()
	(cons (fn (car lst))
	      (map fn (cdr lst)))))

(define (cadr v)
    (car (cdr v)))

(define-macro (let bindings body)
    (cons
     ;; Lambda to introduce bindings
     (list 'lambda
	   (map car bindings)
	   body)
     ;; Parameter list for lambda
     (map cadr bindings)))

(let ((a 1)
      (b 2))
  (+ a b))

`(a ,(+ 1 1) c)
`(a ,@(list 'b 'c 'd) e)
`,@(list 'a 'b)
`(1 ,@(cons 2 3))
;`(1 ,@(cons 2 3) 4)
`(,@1)
`(1 (,@2) 3)
